/*
 * SPDX-FileCopyrightText: Copyright The TrustedFirmware-M Contributors
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *
 */

#ifndef __PLATFORM_ERROR_CODES_H__
#define __PLATFORM_ERROR_CODES_H__

#include <limits.h>

#if TFM_UNIQUE_ERROR_CODES == 1
#include "error_codes_mapping.h"
#else
#define TFM_PLAT_ERROR_BASE 0x1u
#endif /* TFM_UNIQUE_ERROR_CODES */

enum tfm_plat_err_t {
    TFM_PLAT_ERR_SUCCESS = 0,
    /* RSE OTP LCM error codes */
    TFM_PLAT_ERR_OTP_WRITE_INVALID_INPUT = TFM_PLAT_ERROR_BASE,
    TFM_PLAT_ERR_OTP_INIT_CM_ZERO_COUNT_ERR,
    TFM_PLAT_ERR_OTP_INIT_BL1_2_ZERO_COUNT_ERR,
    TFM_PLAT_ERR_OTP_INIT_SOC_ZERO_COUNT_ERR,
    TFM_PLAT_ERR_OTP_INIT_DM_ZERO_COUNT_ERR,
    TFM_PLAT_ERR_OTP_INIT_DYNAMIC_ZERO_COUNT_ERR,
    TFM_PLAT_ERR_OTP_INIT_CM_ROTPK_REPROVISIONING_COUNTER_EXCEEDED,
    TFM_PLAT_ERR_OTP_INIT_DM_ROTPK_REPROVISIONING_COUNTER_EXCEEDED,
    TFM_PLAT_ERR_OTP_INIT_RMA_AREA_SETUP_FAILED,
    TFM_PLAT_ERR_OTP_READ_LCS_INVALID_INPUT,
    TFM_PLAT_ERR_OTP_INIT_LFT_COUNTER_EXCEEDED,
    TFM_PLAT_ERR_OTP_INIT_KRTL_COUNTER_EXCEEDED,
    TFM_PLAT_ERR_OTP_INIT_INVALID_DEVICE_STATUS,
    TFM_PLAT_ERR_OTP_READ_INVALID_INPUT,
    TFM_PLAT_ERR_OTP_READ_INVALID_ID,
    TFM_PLAT_ERR_OTP_ID_NOT_SET_UP,
    TFM_PLAT_ERR_OTP_WRITE_INVALID_ID,
    TFM_PLAT_ERR_OTP_WRITE_ID_NOT_SET_UP,
    TFM_PLAT_ERR_PLAT_OTP_GET_SIZE_INVALID_ID,
    TFM_PLAT_ERR_PLAT_OTP_GET_SIZE_ID_NOT_SET_UP,
    TFM_PLAT_ERR_PLAT_OTP_GET_SIZE_INVALID_INPUT,
    /* RSE ROTPK mapping error codes */
    TFM_PLAT_ERR_ROTPK_GET_TYPE_INVALID_ARGUMENT,
    TFM_PLAT_ERR_ROTPK_GET_POLICY_INVALID_ARGUMENT,
    TFM_PLAT_ERR_ROTPK_GET_HASH_ALG_INVALID_ARGUMENT,
    TFM_PLAT_ERR_ROTPK_GET_TYPE_INVALID_ID,
    TFM_PLAT_ERR_ROTPK_GET_POLICY_INVALID_ID,
    TFM_PLAT_ERR_ROTPK_GET_HASH_ALG_INVALID_ID,
    TFM_PLAT_ERR_ROTPK_GET_TYPE_ROTPK_AREA_INVALID,
    TFM_PLAT_ERR_ROTPK_GET_POLICY_ROTPK_AREA_INVALID,
    TFM_PLAT_ERR_ROTPK_GET_HASH_ALG_ROTPK_AREA_INVALID,
    TFM_PLAT_ERR_IMAGE_HAS_NO_ROTPK_MAPPED,
    /* RSE ROTPK revocation error codes */
    TFM_PLAT_ERR_CM_ROTPK_UPDATE_INVALID_SIZE,
    TFM_PLAT_ERR_CM_ROTPK_UPDATE_INVALID_AREA,
    TFM_PLAT_ERR_DM_ROTPK_UPDATE_INVALID_SIZE,
    TFM_PLAT_ERR_DM_ROTPK_UPDATE_INVALID_AREA,
    /* RSE BL1 provisioning error codes */
    TFM_PLAT_ERR_DM_PROVISIONING_INVALID_DM_AREA_SIZE,
    TFM_PLAT_ERR_PROVISIONING_INVALID_TP_MODE,
    TFM_PLAT_ERR_PROVISIONING_INVALID_SP_MODE,
    TFM_PLAT_ERR_PROVISIONING_INVALID_BLOB_PURPOSE,
    TFM_PLAT_ERR_PROVISIONING_INVALID_BLOB_SEQUENCING,
    TFM_PLAT_ERR_PROVISIONING_INVALID_BLOB_PERSONALIZATION,
    TFM_PLAT_ERR_PROVISIONING_DERIVATION_CM_NOT_PERSONALIZED,
    TFM_PLAT_ERR_PROVISIONING_DERIVATION_DM_NOT_PERSONALIZED,
    TFM_PLAT_ERR_PROVISIONING_DERIVATION_SE_NOT_PERSONALIZED,
    TFM_PLAT_ERR_PROVISIONING_DERIVATION_INVALID_LCS,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_CODE_SIZE,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_DATA_SIZE,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_VALUES_SIZE,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_TAG_LEN,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_CM_ROTPK,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_CURVE,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_HASH_SIZE,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_HASH_VALUE,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_HASH_ALG,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_SIZE,
    TFM_PLAT_ERR_PROVISIONING_BLOB_ZERO_CODE_SIZE,
    TFM_PLAT_ERR_PROVISIONING_MESSAGE_INVALID_TYPE,
    TFM_PLAT_ERR_PROVISIONING_MESSAGE_NO_BLOB_HANDLER,
    TFM_PLAT_ERR_PROVISIONING_MESSAGE_NO_PLAIN_DATA_HANDLER,
    TFM_PLAT_ERR_PROVISIONING_MESSAGE_NO_CERT_HANDLER,
    TFM_PLAT_ERR_PROVISIONING_MESSAGE_INVALID_SIZE,
    TFM_PLAT_ERR_PROVISIONING_MESSAGE_INVALID_LOCATION,
    TFM_PLAT_ERR_PROVISIONING_ROTPK_INVALID_TP_MODE,
    TFM_PLAT_ERR_PROVISIONING_COMMS_MSG_BUFFER_TOO_SMALL,
    TFM_PLAT_ERR_PROVISIONING_BUNDLE_COMBINED_INVALID_LCS,
    TFM_PLAT_ERR_PROVISIONING_SIGNATURE_TYPE_NOT_SUPPORTED,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_DECRYPTION_CONFIG,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_PURPOSE,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_LCS,
    TFM_PLAT_ERR_PROVISIONING_BLOB_INVALID_TP_MODE,
    TFM_PLAT_ERR_PROVISIONING_DEVICE_STATUS_TAMPERING_DETECTED,
    TFM_PLAT_ERR_PROVISIONING_CM_TAMPERING_DETECTED,
    TFM_PLAT_ERR_PROVISIONING_START_FAILED,
    TFM_PLAT_ERR_PROVISIONING_DEBUG_DISABLE_FAILED,
    TFM_PLAT_ERR_PROVISIONING_DEBUG_DISABLED_CHECK_FAILED,
    TFM_PLAT_ERR_PROVISIONING_MESSAGE_NOT_FOUND,
    TFM_PLAT_ERR_PROVISIONING_PLAIN_DATA_NO_TYPE,
    TFM_PLAT_ERR_PROVISIONING_PLAIN_DATA_TYPE_INVALID,
    TFM_PLAT_ERR_PROVISIONING_PLAIN_DATA_INVALID_CM_POLICY,
    TFM_PLAT_ERR_PROVISIONING_PLAIN_DATA_INVALID_SIZE,
    TFM_PLAT_ERR_BL1_2_PROVISIONING_NOT_REQUIRED,
    /* RSE provisioning comms error codes */
    TFM_PLAT_ERR_PROVISIONING_COMMS_UNSUPPORTED,
    /* RSE SOC UID error codes */
    TFM_PLAT_ERR_SOC_UID_ALREADY_GENERATED,
    TFM_PLAT_ERR_SOC_UID_NOT_GENERATED,
    /* RSE key derivation error codes */
    TFM_PLAT_ERR_KEY_DERIVATION_BOOT_STATE_BUFFER_TOO_SMALL,
    TFM_PLAT_ERR_KEY_DERIVATION_INVALID_TP_MODE,
    TFM_PLAT_ERR_KEY_DERIVATION_DERIVATION_SLOT_TOO_SMALL,
    TFM_PLAT_ERR_KEY_DERIVATION_OTP_SLOT_TOO_SMALL,
    TFM_PLAT_ERR_KEY_DERIVATION_RNG_SLOT_TOO_SMALL,
    TFM_PLAT_ERR_KEY_DERIVATION_INVALID_BOOT_STATE_WITH_CONTEXT,
    /* RSE boot state error codes */
    TFM_PLAT_ERR_BOOT_STATE_OUTPUT_BUFFER_TOO_SMALL,
    /* RSE NV counters */
    TFM_PLAT_ERR_READ_OTP_COUNTER_SYSTEM_ERR,
    TFM_PLAT_ERR_READ_NV_COUNTER_INVALID_COUNTER_SIZE,
    TFM_PLAT_ERR_READ_NV_COUNTER_UNSUPPORTED,
    TFM_PLAT_ERR_SET_OTP_COUNTER_MAX_VALUE,
    TFM_PLAT_ERR_SET_NV_COUNTER_UNSUPPORTED,
    TFM_PLAT_ERR_ICREMENT_NV_COUNTER_MAX_VALUE,
    /* RSE GPT parser error codes */
    TFM_PLAT_ERR_GPT_STRNCMP_INVALID_INPUT,
    TFM_PLAT_ERR_GPT_STRNCMP_COMPARISON_FAILED,
    TFM_PLAT_ERR_GPT_HEADER_INVALID_SIZE,
    TFM_PLAT_ERR_GPT_HEADER_INVALID_READ,
    TFM_PLAT_ERR_GPT_HEADER_INVALID_SIGNATURE,
    TFM_PLAT_ERR_GPT_ENTRY_INVALID_SIZE,
    TFM_PLAT_ERR_GPT_ENTRY_OVERFLOW,
    TFM_PLAT_ERR_GPT_ENTRY_INVALID_READ,
    TFM_PLAT_ERR_GPT_ENTRY_NOT_FOUND,
    /* RSE FIP parser error codes */
    TFM_PLAT_ERR_FIP_TOC_HEADER_INVALID_READ,
    TFM_PLAT_ERR_FIP_TOC_HEADER_INVALID_NAME,
    TFM_PLAT_ERR_FIP_TOC_ENTRY_OVERFLOW,
    TFM_PLAT_ERR_FIP_TOC_ENTRY_INVALID_READ,
    TFM_PLAT_ERR_FIP_TOC_ENTRY_INVALID_SIZE,
    TFM_PLAT_ERR_GPT_TOC_ENTRY_NOT_FOUND,
    /* RSE Host Flash ATU error codes */
    TFM_PLAT_ERR_HOST_FLASH_SETUP_ATU_SLOT_INVALID_INPUT,
    TFM_PLAT_ERR_HOST_FLASH_SETUP_IMAGE_SLOT_NO_FIP_FOUND,
    TFM_PLAT_ERR_HOST_FLASH_SETUP_IMAGE_SLOT_NO_FIP_MAPPED,
    TFM_PLAT_ERR_HOST_FLASH_SETUP_IMAGE_SLOT_NO_METADATA_FOUND,
    TFM_PLAT_ERR_HOST_FLASH_SETUP_IMAGE_SLOT_NO_PRIVATE_METADATA_FOUND,
    /* RSE handshake error codes */
    TFM_PLAT_ERR_RSE_HANDSHAKE_CLIENT_SESSION_INVALID_HEADER,
    TFM_PLAT_ERR_RSE_HANDSHAKE_CLIENT_VHUK_INVALID_HEADER,
    TFM_PLAT_ERR_RSE_HANDSHAKE_SERVER_SESSION_INVALID_HEADER,
    TFM_PLAT_ERR_RSE_HANDSHAKE_SERVER_VHUK_INVALID_HEADER,
    TFM_PLAT_ERR_RSE_HANDSHAKE_INVALID_PAYLOAD_LENGTH,
    TFM_PLAT_ERR_RSE_HANDSHAKE_INVALID_MESSAGE,
    TFM_PLAT_ERR_RSE_HANDSHAKE_INVALID_REPLY,
    /* RSE ROM crypto error codes */
    TFM_PLAT_ERR_ROM_CRYPTO_SHA256_COMPUTE_INVALID_INPUT,
    TFM_PLAT_ERR_ROM_CRYPTO_AES256_CTR_DECRYPT_INVALID_INPUT,
    TFM_PLAT_ERR_ROM_CRYPTO_AES256_CTR_DECRYPT_INVALID_ALIGNMENT,
    /* RSE ROM trng error codes */
    TFM_PLAT_ERR_ROM_TRNG_GENERATE_RANDOM_INVALID_INPUT,
    /* RSE BL1_2 read image error codes */
    TFM_PLAT_ERR_READ_BL1_2_IMAGE_FLASH_INVALID_READ,
    TFM_PLAT_ERR_BL1_ECDSA_VERIFY_INVALID_KEY_LEN,
    TFM_PLAT_ERR_BL1_ECDSA_VERIFY_INVALID_SIG_LEN,
    /* RSE BL2 error codes */
    TFM_PLAT_ERR_PRE_LOAD_IMG_BY_BL2_FAIL,
    TFM_PLAT_ERR_POST_LOAD_IMG_BY_BL2_FAIL,
    /* RSE zero count error codes */
    TFM_PLAT_ERR_ZERO_COUNT_MISMATCH,
    TFM_PLAT_ERR_ZERO_COUNT_INVALID_ARGUMENT,
    /* Routing tables errors */
    TFM_PLAT_ERR_ROUTING_TABLES_INVALID_RSE_ID,
    /* ASN1 endorsement certificate handling */
    TFM_PLAT_ERR_ASN1_IAK_ENDORSEMENT_SIGNATURE_INVALID_SIZE,
    TFM_PLAT_ERR_ASN1_IAK_ENDORSEMENT_SKI_INVALID_SIZE,
    TFM_PLAT_ERR_ASN1_IAK_ENDORSEMENT_SERIAL_NUMBER_INVALID_SIZE,
    TFM_PLAT_ERR_ASN1_IAK_ENDORSEMENT_KEY_INVALID_SIZE,
    TFM_PLAT_ERR_ASN1_PUBLIC_KEY_INVALID_CURVE,
    TFM_PLAT_ERR_ASN1_PUBLIC_KEY_BUFFER_INVALID_SIZE,
    TFM_PLAT_ERR_ASN1_PUBLIC_KEY_INVALID_KEY_SIZE,
    /* Generic errors */
    TFM_PLAT_ERR_SYSTEM_ERR,
    TFM_PLAT_ERR_MAX_VALUE,
    TFM_PLAT_ERR_INVALID_INPUT,
    TFM_PLAT_ERR_UNSUPPORTED,
    TFM_PLAT_ERR_NOT_PERMITTED,
    /* Following entry is only to ensure the error code of int size */
    TFM_PLAT_ERR_FORCE_UINT_SIZE = UINT_MAX
};

#endif /* __PLATFORM_ERROR_CODES_H__ */
